syntax = "proto3";
package pb;

// 设备登录
message SignIn {
    int64 device_id = 1; // 设备id
    int64 user_id = 2; // 用户id
    string token = 3; // 设备token
}

// 设备登录回执
message SignInACK {
    int32 code = 1; // 返回码
    string message = 2; // 描述
}

// 同步消息触发
message SyncTrigger {
    int64 sync_sequence = 2; // 已经同步的序列号
}

// 消息发送
message MessageSend {
    int32 receiver_type = 1; // 接收者类型，1：user;2:group
    int64 receiver_id = 2; // 用户id或者群组id
    int32 type = 3; // 消息类型，1：文字；2：语音；3：图片;4:文件
    string content = 4; // 消息内容
    int64 send_sequence = 5; // 发送序列号
    int64 send_time = 6; // 消息发送时间戳，精确到毫秒
}

// 消息体
message MessageBody {
    MessageType message_type = 1; // 消息类型
    MessageContent message_content = 2; // 消息内容
}

// 消息类型
enum MessageType {
    Defalut = 0; // 占位，无意义
    Text = 1; // 文本
    Face = 2; // 表情
    Voice = 3; // 声音
    Image = 4; // 图片
    File = 5; // 文件
    Location = 6; // 定位
    custom = 7; // 自定义
}

// 消息内容
message MessageContent {
    string text = 1; // 文本消息文本内容

    string voice_uuid = 2;
    int32 voice_size = 3; // 语音包大小
    int32 voice_duration = 4; // 语音时长
    string voice_url = 5; // 语音文件URL

    int64 face_id = 6; // 表情id

    int32 image_width = 7; // 图片宽度
    int32 image_height = 8; // 图片长度
    string image_url = 9; // 图片URL
    string image_thumbnail_url = 10; // 图片缩略图url

    int64 file_id = 11; // 文件id
    string file_name = 12; // 文件名
    int64 file_size = 13; // 文件大小
    string file_url = 14; // 文件url

    string data = 15; // 自定义消息类型数据
}

// 消息发送回执
message MessageSendACK {
    int64 send_sequence = 1; // 序列号
    int32 code = 2; // 消息发送状态
    string err_info = 3; // 错误信息
}

// 消息投递
message Message {
    int32 type = 1; // 消息投递类型，1：消息同步列表，2：消息发送列表
    repeated MessageItem messages = 2; // 消息列表
}

// 单条消息投递
message MessageItem {
    int64 message_id = 1; //消息id
    int32 sender_type = 2; // 发送者类型
    int64 sender_id = 3; // 发送者id
    int64 sender_device_id = 4; // 发送者设备id
    int32 receiver_type = 5; // 接收者类型，1：user;2:group
    int64 receiver_id = 6; // 用户id或者群组id
    int32 type = 7; // 消息类型
    string content = 8; // 消息内容
    int64 sync_sequence = 9; // 同步序列号
    int64 send_time = 10; // 消息发送时间戳，精确到毫秒
}

// 投递消息回执
message MessageACK {
    int64 message_id = 1; // 消息id
    int64 sync_sequence = 2; //同步序列号
    int64 receive_time = 3; // 消息接收时间戳，精确到毫秒
}
